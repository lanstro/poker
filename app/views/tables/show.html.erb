<% if !@table %>
	<% provide(:title, "No table open") %>
	<p>There is no such table open right now.</p>
	<% if signed_in? %>
		<%= link_to "Start a new table!", new_table_path, class: "btn btn-large btn-primary btn-center" %>
	<% end %>
	<%= link_to "See current list of tables", tables_path, class: "btn btn-large btn-primary btn-center" %>
<% else %>

	<% description = "Stakes: $#{@table.stakes}/point, #{@table.seats} seats, #{ (@table.ais)?"with AIs":"humans only" }" %>
	<% provide(:title, description) %>
	<% card_file_paths %>
	<h1>Table <%= @table.id %></h1>
	<h2><%= description %></h2>

	<div id = "table" data-table_id=<%= @table.id %> data-uri="<%= request.host %>:<%= request.port %>/websocket" data-table_stakes=<%= @table.stakes %>>
		<div id="announcements">
		</div>
		<div id = "opponents">
		</div>
		
		<div id= "protagonist">
			<div id="protagonist_card_values">
			</div>
			<div id="protagonist_cards">
			</div>

			<div id="interface">
				<div id="sort_buttons">

				</div>
				<div id="chat_box">
				</div>
				<div id="utility_buttons">
				</div>
			</div>
		</div>
	</div>

	<script type="text/template" id="opponent_template">
		<div class = "opponent_dashboard">
		</div>
		<div class = "opponent_cards">
		</div>
		<div class = "hand_ranking">
		</div>
	</script>
	
	<script type="text/template" id="opponent_dashboard_template">
		<img class="table_avatar" alt: "avatar" src= <@= $.parseJSON('<%= small_avatar_file_paths.to_json %>'.replace(/&quot;/g, '"'))[avatar] @>  >
		<div class="player_info">
			<p><@= name @></p>
			<p><@= "$"+balance @></p>
			<@= recentChange @>
		</div>
	</script>
	
	<script type = "text/template" id="cards_back_template">
		<%= image_tag("other/back_full_stack.png", alt: "covered cards", class: "covered_cards") %>
	</script>
	
	<script type="text/template" id="card_template">
		<img alt= <@= human_description @> src= <@= $.parseJSON('<%= card_file_paths.to_json %>'.replace(/&quot;/g, '"'))[human_description] @> >
	</script>
	
	<script type ="text/template" id="sort_buttons_template">
		<%= image_tag("other/by_val.png", alt: "sort by value", class: "sort_button", id: "sort_by_val") %>
		<%= image_tag("other/by_suit.png", alt: "sort by suit", class: "sort_button", id: "sort_by_suit") %>
		<%= image_tag("other/swap_cards.png", alt: "swap cards", class: "sort_button", id: "swap_cards") %>
	</script>
	
	<script type = "text/template" id="protagonist_card_values_template">
		<p class="protagonist_card_description"><%%= descriptions[FRONT_HAND] %></p>
		<p class="protagonist_card_description"><%%= descriptions[MID_HAND] %></p>
		<p class="protagonist_card_description"><%%= descriptions[BACK_HAND] %></p>
	</script>
	
	<script type = "text/template" id="chat_template">
		<textarea id="log" readonly rows=7></textarea>
		</textarea>
		<form id="input">
				<input type="text" id="message_input" autocomplete="off">
				<input type="submit" id="send_button" value="Send">
		</form>
	</script>
	
	<script type = "text/template" id="hand_ranking_button_template">
		<img alt = <@= rank @> src = <@= $.parseJSON('<%= hand_ranking_icon_paths.to_json %>'.replace(/&quot;/g, '"'))[rank] @> >
	</script>
	
	<script type = "text/template" id="utility_buttons_template">
		<ul>
			<li id="join">	
				<input class="btn btn-large btn-primary menu_button" value="Buy in" type = "submit">
			</li>
			<li id="leave">	
				<%= form_for(@table, :url => leave_table_path, :html=> {:method => :post}, remote: true ) do |f| %>
					<%= f.submit("Leave table", {class: "btn btn-large btn-primary menu_button"}) %>
				<% end %>
			</li>
			<li id="sitout">	
				<%= form_for(@table, :url => sitout_table_path, :html=> {:method => :post}, remote: true ) do |f| %>
					<%= f.submit("Sit out", {class: "btn btn-large btn-primary menu_button"}) %>
				<% end %>
			</li>
			<li id="fold">	
				<%= form_for(@table, :url => fold_table_path, :html=> {:method => :post}, remote: true ) do |f| %>
					<%= f.submit("Fold", {class: "btn btn-large btn-primary menu_button"}) %>
				<% end %>
			</li>
			<li id="ready">	
				<%= form_for(@table, :url => ready_table_path, :html=> {:method => :post}, remote: true ) do |f| %>
					<%= f.submit("Ready", {class: "btn btn-large btn-primary menu_button"}) %>
				<% end %>
			</li>
		</ul>
	</script>
	
<% end %>